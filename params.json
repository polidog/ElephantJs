{"name":"Elephantjs","tagline":"ElephantJs is a library for running javascript from php","body":"# ElephantJs\r\n\r\n\r\n![zou](http://www.polidog.jp/images/zou.gif)\r\n\r\nElephantJsは、PHPからJavascritpを実行するためのライブラリです。  \r\n使用するためにはV8Jsが必要です。\r\nそれから、もちろんV8エンジンも必要なわけです。   \r\n\r\nMacで使う場合\r\n\r\n\tbrew install v8\r\n\tpecl install v8js-0.1.3\r\n  \r\n\t\r\n\r\n\r\n### 使い方\r\n----\r\n\r\n\r\n\trequire 'ElephantJs.php';\r\n\t\r\n\t$a = \"ElephantJs samples string a\";\r\n\r\n\t// 普通に動かす\r\n\t$jsElephant = new ElephantJs(get_defined_vars());\r\n\t$jsElephant->execute('print(PHP.getVars(\"a\",\"local\") + \"\\n\");');\r\n\r\nこれで実行すれば、以下のように出力されます  \r\n\r\n\tElephantJs samples string a\r\n\r\nファイルから実行したい場合は\r\n\r\n\trequire 'ElephantJs.php';\r\n\t$jsElephant = new ElephantJs(get_defined_vars());\r\n\t$jsElephant->executeFile('sample.js');\r\n\t\r\nとファイル名を指定すれば実行できます。  \r\n実行したいディレクトリが別の場所の場合は指定することもできます。  \r\n\r\n\trequire 'ElephantJs.php';\r\n\t$jsElephant = new ElephantJs(get_defined_vars());\r\n\t$jsElephant->executeFile('sample.js','/var/www/html/js');\r\n\t\r\n_注意_ コンストラクタで必ずget_defined_vars()を引数として実行しないとローカルスコープの変数が取得できません。\r\n\r\n\r\n#### Javascriptオブジェクトについて\r\n----\r\n\r\nElephantJsで実行した場合にPHPという変数名でJavascript側にオブジェクトが渡されます。  \r\n今のところメソッドは以下のものを用意しています。\r\n\r\n\tPHP.getVars('変数名','local'); // 第二引数はlocal or globalを指定する\r\n\r\nPHP.getVars()を実行することによりPHP側の変数を取得する事ができます。 \r\nあと実行しているPHPのバージョンを取得したい場合は、PHP.versionで取得できます。\r\n\r\nちなみに、メソッドが足りない場合にPHP側からメソッドを動的に増やす事も出来ます。\r\n\r\n例:printlnを追加する  \r\n\r\n\t$jsElephant->attachJs(array(\r\n\t\t'println' => 'function(key) { print( key + \"\\n\") };'\r\n\t));\r\n\t$jsElephant->execute('PHP.println(\"これはJavascriptです。うそではないです。\");');\r\n\r\n\r\n","google":"UA-35796846-1","note":"Don't delete this file! It's used internally to help with page regeneration."}